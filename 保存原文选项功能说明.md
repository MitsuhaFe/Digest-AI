# ä¿å­˜åŸæ–‡é€‰é¡¹åŠŸèƒ½è¯´æ˜

## åŠŸèƒ½æ¦‚è¿°

æ–°å¢äº†"ä¿å­˜æ–‡ç« åŸæ–‡"é€‰é¡¹ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©åœ¨ä¿å­˜æ–‡ç« æ—¶æ˜¯å¦ä¿å­˜åŸæ–‡å†…å®¹ã€‚å¦‚æœé€‰æ‹©ä¸ä¿å­˜åŸæ–‡ï¼Œç³»ç»Ÿå°†åªä¿ç•™ AI ç”Ÿæˆçš„æ‘˜è¦å’Œå…³é”®è§‚ç‚¹ï¼Œå¤§å¹…å‡å°å­˜å‚¨ç©ºé—´å ç”¨ã€‚

## å®ç°çš„æ›´æ”¹

### 1. è®¾ç½®é¡µé¢ (`settings.html`)

**ä½ç½®**: å†…å®¹ä¿å­˜è®¾ç½®åŒºåŸŸ

æ–°å¢äº†ä¸€ä¸ªå¤é€‰æ¡†ï¼š
```html
<div class="setting-item">
  <label class="checkbox-label">
    <input type="checkbox" id="saveOriginalContentCheckbox" checked />
    ä¿å­˜æ–‡ç« åŸæ–‡å†…å®¹
  </label>
  <p class="setting-hint">å…³é—­ååªä¿å­˜ AI æ‘˜è¦å’Œå…³é”®è§‚ç‚¹ï¼Œä¸ä¿å­˜æ–‡ç« åŸæ–‡ï¼ˆå¤§å¹…å‡å°å­˜å‚¨ç©ºé—´ï¼Œä½†æ— æ³•æŸ¥çœ‹å®Œæ•´åŸæ–‡ï¼‰</p>
</div>
```

**é»˜è®¤å€¼**: å·²å‹¾é€‰ï¼ˆä¿å­˜åŸæ–‡ï¼‰

### 2. è®¾ç½®é€»è¾‘ (`settings.js`)

#### æ·»åŠ çš„ DOM å…ƒç´ å¼•ç”¨
```javascript
saveOriginalContentCheckbox: document.getElementById('saveOriginalContentCheckbox')
```

#### loadSettings å‡½æ•°
- æ·»åŠ äº† `'saveOriginalContent'` åˆ°å­˜å‚¨è¯»å–åˆ—è¡¨
- åŠ è½½å¹¶åº”ç”¨ç”¨æˆ·è®¾ç½®ï¼š
  ```javascript
  const saveOriginalContent = settings.saveOriginalContent !== undefined ? settings.saveOriginalContent : true;
  elements.saveOriginalContentCheckbox.checked = saveOriginalContent;
  ```

#### saveSettings å‡½æ•°
- å°† `saveOriginalContent` è®¾ç½®ä¿å­˜åˆ° `chrome.storage.local`ï¼š
  ```javascript
  saveOriginalContent: elements.saveOriginalContentCheckbox.checked
  ```

### 3. åå°è„šæœ¬ (`scripts/background.js`)

#### handleSaveArticle å‡½æ•°ä¿®æ”¹

**è¯»å–è®¾ç½®**:
```javascript
const settings = await chrome.storage.local.get([
  // ... å…¶ä»–è®¾ç½®
  'saveOriginalContent',
  'saveImages'
]);
```

**å¤„ç†åŸæ–‡å†…å®¹**:
```javascript
const saveOriginalContent = settings.saveOriginalContent !== undefined ? settings.saveOriginalContent : true;
let htmlContent = extractedContent.htmlContent || '';
let textContent = extractedContent.content || '';

if (!saveOriginalContent) {
  // ä¸ä¿å­˜åŸæ–‡ï¼Œæ¸…ç©ºå†…å®¹
  textContent = '';
  htmlContent = '';
  console.log('å·²æ¸…ç©ºåŸæ–‡å†…å®¹ï¼Œä»…ä¿å­˜æ‘˜è¦');
}
```

**æ–‡ç« å¯¹è±¡**:
```javascript
const article = {
  // ... å…¶ä»–å­—æ®µ
  content: textContent,
  htmlContent: htmlContent,
  hasOriginalContent: saveOriginalContent  // æ ‡è®°æ˜¯å¦ä¿å­˜äº†åŸæ–‡
};
```

### 4. é˜…è¯»åº“é¡µé¢ (`dashboard.js`)

#### æ˜¾ç¤ºé€»è¾‘ä¼˜åŒ–

æ·»åŠ äº†å¯¹ `hasOriginalContent` å­—æ®µçš„æ£€æŸ¥ï¼Œå½“æ²¡æœ‰åŸæ–‡æ—¶æ˜¾ç¤ºå‹å¥½çš„æç¤ºä¿¡æ¯ï¼š

```javascript
if (article.htmlContent) {
  elements.articleBody.innerHTML = sanitizeHtml(article.htmlContent);
} else if (article.content) {
  elements.articleBody.textContent = article.content;
} else if (article.hasOriginalContent === false) {
  // ç”¨æˆ·é€‰æ‹©ä¸ä¿å­˜åŸæ–‡ - æ˜¾ç¤ºæç¤ºä¿¡æ¯
  elements.articleBody.innerHTML = `
    <div style="text-align: center; padding: 40px 20px; color: #666;">
      <div style="font-size: 48px; margin-bottom: 16px;">ğŸ“</div>
      <p style="font-size: 16px; margin-bottom: 8px;">æ­¤æ–‡ç« æœªä¿å­˜åŸæ–‡å†…å®¹</p>
      <p style="font-size: 14px; color: #999;">ä»…ä¿å­˜äº† AI ç”Ÿæˆçš„æ‘˜è¦å’Œå…³é”®è§‚ç‚¹</p>
      <a href="${article.url}" target="_blank" ...>è®¿é—®åŸæ–‡é“¾æ¥</a>
    </div>
  `;
} else {
  elements.articleBody.textContent = 'å†…å®¹ä¸å¯ç”¨';
}
```

## ç”¨æˆ·ä½“éªŒ

### ä¿å­˜æ—¶
- **å‹¾é€‰"ä¿å­˜æ–‡ç« åŸæ–‡"** (é»˜è®¤): å®Œæ•´ä¿å­˜æ–‡ç« çš„ HTML å’Œæ–‡æœ¬å†…å®¹
- **å–æ¶ˆå‹¾é€‰**: åªä¿å­˜ AI æ‘˜è¦ã€å…³é”®è§‚ç‚¹å’Œå…ƒæ•°æ®ï¼Œä¸ä¿å­˜åŸæ–‡

### æŸ¥çœ‹æ—¶
- **æœ‰åŸæ–‡**: æ­£å¸¸æ˜¾ç¤ºæ–‡ç« å†…å®¹ï¼Œæ”¯æŒé«˜äº®å’Œç¬”è®°åŠŸèƒ½
- **æ— åŸæ–‡**: æ˜¾ç¤ºå‹å¥½æç¤ºï¼Œæä¾›"è®¿é—®åŸæ–‡é“¾æ¥"æŒ‰é’®ç›´æ¥è·³è½¬åˆ°åŸç½‘é¡µ

## å­˜å‚¨ç©ºé—´ä¼˜åŒ–

ä¸ä¿å­˜åŸæ–‡å¯ä»¥å¤§å¹…å‡å°å­˜å‚¨å ç”¨ï¼š
- **å…¸å‹æ–‡ç« **: ä» 50-200KB å‡å°åˆ° 5-10KBï¼ˆçº¦ 90% çš„ç©ºé—´èŠ‚çœï¼‰
- **é•¿æ–‡ç« **: ä» 500KB+ å‡å°åˆ° 10-20KBï¼ˆçº¦ 95%+ çš„ç©ºé—´èŠ‚çœï¼‰

è¿™å¯¹äºéœ€è¦ä¿å­˜å¤§é‡æ–‡ç« çš„ç”¨æˆ·ç‰¹åˆ«æœ‰ç”¨ã€‚

## æ³¨æ„äº‹é¡¹

1. **AI ç”Ÿæˆä»éœ€è¦åŸæ–‡**: å³ä½¿å…³é—­äº†"ä¿å­˜åŸæ–‡"ï¼ŒAI ä»ç„¶éœ€è¦è¯»å–åŸæ–‡æ¥ç”Ÿæˆæ‘˜è¦ï¼Œåªæ˜¯ç”Ÿæˆåä¸ä¼šä¿å­˜åŸæ–‡å†…å®¹ã€‚

2. **é«˜äº®å’Œç¬”è®°åŠŸèƒ½**: å¦‚æœæ–‡ç« æ²¡æœ‰ä¿å­˜åŸæ–‡ï¼Œåˆ™æ— æ³•ä½¿ç”¨é«˜äº®å’Œç¬”è®°åŠŸèƒ½ã€‚

3. **å‘åå…¼å®¹**: æ—§ç‰ˆæœ¬ä¿å­˜çš„æ–‡ç« ï¼ˆæ²¡æœ‰ `hasOriginalContent` å­—æ®µï¼‰ä¼šè¢«å½“ä½œæœ‰åŸæ–‡å¤„ç†ã€‚

4. **ä¸"ä¿å­˜å›¾ç‰‡"é€‰é¡¹çš„å…³ç³»**: 
   - å¦‚æœåŒæ—¶å…³é—­ä¸¤ä¸ªé€‰é¡¹ï¼Œæ–‡ç« å°†åªä¿ç•™çº¯æ–‡æœ¬æ‘˜è¦
   - å¦‚æœåªå…³é—­"ä¿å­˜åŸæ–‡"ï¼Œåˆ™"ä¿å­˜å›¾ç‰‡"é€‰é¡¹æ— æ•ˆï¼ˆå› ä¸ºæ²¡æœ‰ HTML å†…å®¹ï¼‰

## æµ‹è¯•å»ºè®®

1. **æµ‹è¯•åœºæ™¯ 1**: å‹¾é€‰"ä¿å­˜åŸæ–‡"ï¼ŒéªŒè¯æ–‡ç« æ­£å¸¸ä¿å­˜å’Œæ˜¾ç¤º
2. **æµ‹è¯•åœºæ™¯ 2**: å–æ¶ˆå‹¾é€‰"ä¿å­˜åŸæ–‡"ï¼Œä¿å­˜æ–‡ç« åæŸ¥çœ‹åªæœ‰æ‘˜è¦
3. **æµ‹è¯•åœºæ™¯ 3**: éªŒè¯æç¤ºä¿¡æ¯å’Œ"è®¿é—®åŸæ–‡é“¾æ¥"æŒ‰é’®åŠŸèƒ½
4. **æµ‹è¯•åœºæ™¯ 4**: æ£€æŸ¥å­˜å‚¨ç©ºé—´å ç”¨å¯¹æ¯”

## å®Œæˆæ—¶é—´

2025-01-22

