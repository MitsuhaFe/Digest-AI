{"version":3,"file":"floatButton.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","sources":["webpack://digest-ai-extension/./scripts/floatButton.js"],"sourcesContent":["/**\r\n * ÊÇ¨ÊµÆÊåâÈíÆÂäüËÉΩ\r\n * Âú®È°µÈù¢‰∏äÊòæÁ§∫‰∏Ä‰∏™ÂèØÊãñÂä®ÁöÑÊÇ¨ÊµÆÁêÉÔºåÁÇπÂáªÂø´ÈÄü‰øùÂ≠òÊñáÁ´†\r\n */\r\n\r\nclass FloatButton {\r\n  constructor() {\r\n    this.button = null;\r\n    this.isDragging = false;\r\n    this.startX = 0;\r\n    this.startY = 0;\r\n    this.offsetX = 0;\r\n    this.offsetY = 0;\r\n    this.enabled = true;\r\n  }\r\n\r\n  /**\r\n   * ÂàùÂßãÂåñÊÇ¨ÊµÆÁêÉ\r\n   */\r\n  async init() {\r\n    // Ê£ÄÊü•ÊòØÂê¶ÂêØÁî®ÊÇ¨ÊµÆÁêÉ\r\n    const settings = await chrome.storage.local.get(['enableFloatButton']);\r\n    this.enabled = settings.enableFloatButton !== undefined ? settings.enableFloatButton : true;\r\n    \r\n    if (!this.enabled) {\r\n      this.remove();\r\n      return;\r\n    }\r\n    \r\n    // Â¶ÇÊûúÂ∑≤Â≠òÂú®ÔºåÂÖàÁßªÈô§\r\n    this.remove();\r\n    \r\n    // ÂàõÂª∫ÊÇ¨ÊµÆÁêÉ\r\n    this.button = document.createElement('div');\r\n    this.button.id = 'digest-ai-float-button';\r\n    this.button.innerHTML = `\r\n      <div class=\"float-btn-icon\">üìö</div>\r\n      <div class=\"float-btn-tooltip\">‰øùÂ≠òÊñáÁ´†</div>\r\n    `;\r\n    \r\n    // Ê∑ªÂä†Ê†∑Âºè\r\n    this.injectStyles();\r\n    \r\n    // Ê∑ªÂä†Âà∞È°µÈù¢\r\n    document.body.appendChild(this.button);\r\n    \r\n    // ÁªëÂÆö‰∫ã‰ª∂\r\n    this.bindEvents();\r\n    \r\n    // ‰ªéÂ≠òÂÇ®Âä†ËΩΩ‰ΩçÁΩÆ\r\n    await this.loadPosition();\r\n  }\r\n\r\n  /**\r\n   * Ê≥®ÂÖ•Ê†∑Âºè\r\n   */\r\n  injectStyles() {\r\n    if (document.getElementById('digest-ai-float-styles')) {\r\n      return;\r\n    }\r\n    \r\n    const style = document.createElement('style');\r\n    style.id = 'digest-ai-float-styles';\r\n    style.textContent = `\r\n      #digest-ai-float-button {\r\n        position: fixed;\r\n        right: 20px;\r\n        bottom: 100px;\r\n        width: 56px;\r\n        height: 56px;\r\n        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);\r\n        border-radius: 50%;\r\n        box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);\r\n        cursor: pointer;\r\n        z-index: 2147483647;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);\r\n        user-select: none;\r\n      }\r\n      \r\n      #digest-ai-float-button:hover {\r\n        transform: scale(1.1);\r\n        box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);\r\n      }\r\n      \r\n      #digest-ai-float-button:active {\r\n        transform: scale(0.95);\r\n      }\r\n      \r\n      #digest-ai-float-button.dragging {\r\n        cursor: grabbing;\r\n        opacity: 0.8;\r\n      }\r\n      \r\n      .float-btn-icon {\r\n        font-size: 24px;\r\n        line-height: 1;\r\n      }\r\n      \r\n      .float-btn-tooltip {\r\n        position: absolute;\r\n        right: 70px;\r\n        background: rgba(0, 0, 0, 0.8);\r\n        color: white;\r\n        padding: 6px 12px;\r\n        border-radius: 6px;\r\n        font-size: 13px;\r\n        white-space: nowrap;\r\n        opacity: 0;\r\n        pointer-events: none;\r\n        transition: opacity 0.2s;\r\n      }\r\n      \r\n      #digest-ai-float-button:hover .float-btn-tooltip {\r\n        opacity: 1;\r\n      }\r\n      \r\n      .float-btn-tooltip::after {\r\n        content: '';\r\n        position: absolute;\r\n        right: -6px;\r\n        top: 50%;\r\n        transform: translateY(-50%);\r\n        border: 6px solid transparent;\r\n        border-left-color: rgba(0, 0, 0, 0.8);\r\n      }\r\n      \r\n      #digest-ai-float-button.saving {\r\n        animation: pulse 1s ease-in-out infinite;\r\n      }\r\n      \r\n      @keyframes pulse {\r\n        0%, 100% {\r\n          transform: scale(1);\r\n        }\r\n        50% {\r\n          transform: scale(1.05);\r\n        }\r\n      }\r\n    `;\r\n    \r\n    document.head.appendChild(style);\r\n  }\r\n\r\n  /**\r\n   * ÁªëÂÆö‰∫ã‰ª∂\r\n   */\r\n  bindEvents() {\r\n    if (!this.button) return;\r\n    \r\n    // Èº†Ê†á‰∫ã‰ª∂\r\n    this.button.addEventListener('mousedown', this.handleMouseDown.bind(this));\r\n    document.addEventListener('mousemove', this.handleMouseMove.bind(this));\r\n    document.addEventListener('mouseup', this.handleMouseUp.bind(this));\r\n    \r\n    // Ëß¶Êë∏‰∫ã‰ª∂ÔºàÁßªÂä®Á´ØÔºâ\r\n    this.button.addEventListener('touchstart', this.handleTouchStart.bind(this), { passive: false });\r\n    document.addEventListener('touchmove', this.handleTouchMove.bind(this), { passive: false });\r\n    document.addEventListener('touchend', this.handleTouchEnd.bind(this));\r\n  }\r\n\r\n  /**\r\n   * Èº†Ê†áÊåâ‰∏ã\r\n   */\r\n  handleMouseDown(e) {\r\n    if (e.button !== 0) return; // Âè™Â§ÑÁêÜÂ∑¶ÈîÆ\r\n    \r\n    this.isDragging = true;\r\n    this.button.classList.add('dragging');\r\n    \r\n    const rect = this.button.getBoundingClientRect();\r\n    this.offsetX = e.clientX - rect.left;\r\n    this.offsetY = e.clientY - rect.top;\r\n    this.startX = e.clientX;\r\n    this.startY = e.clientY;\r\n    \r\n    e.preventDefault();\r\n  }\r\n\r\n  /**\r\n   * Èº†Ê†áÁßªÂä®\r\n   */\r\n  handleMouseMove(e) {\r\n    if (!this.isDragging) return;\r\n    \r\n    const x = e.clientX - this.offsetX;\r\n    const y = e.clientY - this.offsetY;\r\n    \r\n    this.updatePosition(x, y);\r\n    e.preventDefault();\r\n  }\r\n\r\n  /**\r\n   * Èº†Ê†áÈáäÊîæ\r\n   */\r\n  handleMouseUp(e) {\r\n    if (!this.isDragging) return;\r\n    \r\n    this.isDragging = false;\r\n    this.button.classList.remove('dragging');\r\n    \r\n    // Âà§Êñ≠ÊòØÂê¶‰∏∫ÁÇπÂáªÔºàÁßªÂä®Ë∑ùÁ¶ªÂ∞è‰∫é5pxÔºâ\r\n    const moveDistance = Math.sqrt(\r\n      Math.pow(e.clientX - this.startX, 2) + \r\n      Math.pow(e.clientY - this.startY, 2)\r\n    );\r\n    \r\n    if (moveDistance < 5) {\r\n      // Ëß¶ÂèëÁÇπÂáª‰∫ã‰ª∂\r\n      this.handleClick();\r\n    } else {\r\n      // ‰øùÂ≠ò‰ΩçÁΩÆ\r\n      this.savePosition();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ëß¶Êë∏ÂºÄÂßã\r\n   */\r\n  handleTouchStart(e) {\r\n    if (e.touches.length !== 1) return;\r\n    \r\n    this.isDragging = true;\r\n    this.button.classList.add('dragging');\r\n    \r\n    const touch = e.touches[0];\r\n    const rect = this.button.getBoundingClientRect();\r\n    this.offsetX = touch.clientX - rect.left;\r\n    this.offsetY = touch.clientY - rect.top;\r\n    this.startX = touch.clientX;\r\n    this.startY = touch.clientY;\r\n    \r\n    e.preventDefault();\r\n  }\r\n\r\n  /**\r\n   * Ëß¶Êë∏ÁßªÂä®\r\n   */\r\n  handleTouchMove(e) {\r\n    if (!this.isDragging || e.touches.length !== 1) return;\r\n    \r\n    const touch = e.touches[0];\r\n    const x = touch.clientX - this.offsetX;\r\n    const y = touch.clientY - this.offsetY;\r\n    \r\n    this.updatePosition(x, y);\r\n    e.preventDefault();\r\n  }\r\n\r\n  /**\r\n   * Ëß¶Êë∏ÁªìÊùü\r\n   */\r\n  handleTouchEnd(e) {\r\n    if (!this.isDragging) return;\r\n    \r\n    this.isDragging = false;\r\n    this.button.classList.remove('dragging');\r\n    \r\n    const touch = e.changedTouches[0];\r\n    const moveDistance = Math.sqrt(\r\n      Math.pow(touch.clientX - this.startX, 2) + \r\n      Math.pow(touch.clientY - this.startY, 2)\r\n    );\r\n    \r\n    if (moveDistance < 5) {\r\n      this.handleClick();\r\n    } else {\r\n      this.savePosition();\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Êõ¥Êñ∞‰ΩçÁΩÆ\r\n   */\r\n  updatePosition(x, y) {\r\n    if (!this.button) return;\r\n    \r\n    // ÈôêÂà∂Âú®Á™óÂè£ÂÜÖ\r\n    const maxX = window.innerWidth - this.button.offsetWidth;\r\n    const maxY = window.innerHeight - this.button.offsetHeight;\r\n    \r\n    x = Math.max(0, Math.min(x, maxX));\r\n    y = Math.max(0, Math.min(y, maxY));\r\n    \r\n    this.button.style.left = `${x}px`;\r\n    this.button.style.top = `${y}px`;\r\n    this.button.style.right = 'auto';\r\n    this.button.style.bottom = 'auto';\r\n  }\r\n\r\n  /**\r\n   * Â§ÑÁêÜÁÇπÂáª\r\n   */\r\n  async handleClick() {\r\n    if (!this.button) return;\r\n    \r\n    // Ê∑ªÂä†‰øùÂ≠òÂä®Áîª\r\n    this.button.classList.add('saving');\r\n    \r\n    try {\r\n      // ÂèëÈÄÅ‰øùÂ≠òÊ∂àÊÅØÂà∞ background\r\n      const response = await chrome.runtime.sendMessage({\r\n        action: 'saveArticle',\r\n        url: window.location.href,\r\n        title: document.title\r\n      });\r\n      \r\n      if (response.success) {\r\n        // ÊàêÂäüÊèêÁ§∫\r\n        this.showToast('‚úÖ ÊñáÁ´†Â∑≤‰øùÂ≠ò', 'success');\r\n      } else {\r\n        throw new Error(response.error || '‰øùÂ≠òÂ§±Ë¥•');\r\n      }\r\n    } catch (error) {\r\n      console.error('‰øùÂ≠òÊñáÁ´†Â§±Ë¥•:', error);\r\n      this.showToast('‚ùå ' + error.message, 'error');\r\n    } finally {\r\n      this.button.classList.remove('saving');\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ÊòæÁ§∫ÊèêÁ§∫Ê∂àÊÅØ\r\n   */\r\n  showToast(message, type = 'info') {\r\n    // ÁßªÈô§Áé∞ÊúâÁöÑ toast\r\n    const existingToast = document.getElementById('digest-ai-toast');\r\n    if (existingToast) {\r\n      existingToast.remove();\r\n    }\r\n    \r\n    // ÂàõÂª∫Êñ∞ÁöÑ toast\r\n    const toast = document.createElement('div');\r\n    toast.id = 'digest-ai-toast';\r\n    toast.textContent = message;\r\n    toast.className = `digest-ai-toast ${type}`;\r\n    \r\n    // Ê≥®ÂÖ• toast Ê†∑Âºè\r\n    if (!document.getElementById('digest-ai-toast-styles')) {\r\n      const style = document.createElement('style');\r\n      style.id = 'digest-ai-toast-styles';\r\n      style.textContent = `\r\n        .digest-ai-toast {\r\n          position: fixed;\r\n          top: 20px;\r\n          left: 50%;\r\n          transform: translateX(-50%);\r\n          background: rgba(0, 0, 0, 0.9);\r\n          color: white;\r\n          padding: 12px 24px;\r\n          border-radius: 8px;\r\n          font-size: 14px;\r\n          z-index: 1000000;\r\n          animation: slideDown 0.3s ease-out;\r\n        }\r\n        \r\n        .digest-ai-toast.success {\r\n          background: linear-gradient(135deg, #10b981 0%, #059669 100%);\r\n        }\r\n        \r\n        .digest-ai-toast.error {\r\n          background: linear-gradient(135deg, #ef4444 0%, #dc2626 100%);\r\n        }\r\n        \r\n        @keyframes slideDown {\r\n          from {\r\n            opacity: 0;\r\n            transform: translateX(-50%) translateY(-20px);\r\n          }\r\n          to {\r\n            opacity: 1;\r\n            transform: translateX(-50%) translateY(0);\r\n          }\r\n        }\r\n      `;\r\n      document.head.appendChild(style);\r\n    }\r\n    \r\n    document.body.appendChild(toast);\r\n    \r\n    // 3ÁßíÂêéÁßªÈô§\r\n    setTimeout(() => {\r\n      toast.style.animation = 'slideDown 0.3s ease-out reverse';\r\n      setTimeout(() => toast.remove(), 300);\r\n    }, 3000);\r\n  }\r\n\r\n  /**\r\n   * ‰øùÂ≠ò‰ΩçÁΩÆÂà∞Â≠òÂÇ®\r\n   */\r\n  async savePosition() {\r\n    if (!this.button) return;\r\n    \r\n    const position = {\r\n      left: this.button.style.left,\r\n      top: this.button.style.top\r\n    };\r\n    \r\n    await chrome.storage.local.set({ floatButtonPosition: position });\r\n  }\r\n\r\n  /**\r\n   * ‰ªéÂ≠òÂÇ®Âä†ËΩΩ‰ΩçÁΩÆ\r\n   */\r\n  async loadPosition() {\r\n    if (!this.button) return;\r\n    \r\n    const { floatButtonPosition } = await chrome.storage.local.get(['floatButtonPosition']);\r\n    \r\n    if (floatButtonPosition && floatButtonPosition.left && floatButtonPosition.top) {\r\n      // ËØªÂèñÂπ∂ÈôêÂà∂Âú®ÂΩìÂâçÂèØËßÜÂå∫ÂüüÂÜÖÔºåÈÅøÂÖçË¢´‰øùÂ≠òÂà∞Â±èÂπïÂ§ñÂØºËá¥‚ÄúÁúã‰∏çËßÅ‚Äù\r\n      const leftPx = parseInt(floatButtonPosition.left, 10);\r\n      const topPx = parseInt(floatButtonPosition.top, 10);\r\n      const maxX = window.innerWidth - 56;\r\n      const maxY = window.innerHeight - 56;\r\n      const clampedLeft = Math.max(0, Math.min(isNaN(leftPx) ? 0 : leftPx, maxX));\r\n      const clampedTop = Math.max(0, Math.min(isNaN(topPx) ? 0 : topPx, maxY));\r\n\r\n      this.button.style.left = `${clampedLeft}px`;\r\n      this.button.style.top = `${clampedTop}px`;\r\n      this.button.style.right = 'auto';\r\n      this.button.style.bottom = 'auto';\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ÁßªÈô§ÊÇ¨ÊµÆÁêÉ\r\n   */\r\n  remove() {\r\n    if (this.button) {\r\n      this.button.remove();\r\n      this.button = null;\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Êõ¥Êñ∞ÊÇ¨ÊµÆÁêÉÁä∂ÊÄÅ\r\n   */\r\n  async updateState() {\r\n    const settings = await chrome.storage.local.get(['enableFloatButton']);\r\n    const newEnabled = settings.enableFloatButton !== undefined ? settings.enableFloatButton : true;\r\n    \r\n    if (newEnabled !== this.enabled) {\r\n      this.enabled = newEnabled;\r\n      if (newEnabled) {\r\n        await this.init();\r\n      } else {\r\n        this.remove();\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n// ÂàõÂª∫ÂÖ®Â±ÄÂÆû‰æã\r\nconst floatButton = new FloatButton();\r\n\r\n// È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ\r\nif (document.readyState === 'loading') {\r\n  document.addEventListener('DOMContentLoaded', () => floatButton.init());\r\n} else {\r\n  floatButton.init();\r\n}\r\n\r\n// ÁõëÂê¨ËÆæÁΩÆÂèòÂåñ\r\nchrome.storage.onChanged.addListener((changes, areaName) => {\r\n  if (areaName === 'local' && changes.enableFloatButton) {\r\n    floatButton.updateState();\r\n  }\r\n});\r\n\r\n// ÂØºÂá∫‰æõÂÖ∂‰ªñËÑöÊú¨‰ΩøÁî®\r\nif (typeof window !== 'undefined') {\r\n  window.digestAIFloatButton = floatButton;\r\n}\r\n\r\n"],"names":[],"sourceRoot":""}