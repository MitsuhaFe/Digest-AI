const THEMES={light:{"--bg-primary":"#ffffff","--bg-secondary":"#f5f7fa","--bg-tertiary":"#fafafa","--text-primary":"#1f2937","--text-secondary":"#4b5563","--text-tertiary":"#6b7280","--border-color":"#e5e7eb","--border-light":"#f3f4f6","--gradient-start":"#667eea","--gradient-end":"#764ba2","--shadow":"rgba(0, 0, 0, 0.1)","--ai-bg":"linear-gradient(135deg, #f0f4ff 0%, #faf5ff 100%)"},dark:{"--bg-primary":"#1f2937","--bg-secondary":"#111827","--bg-tertiary":"#0f172a","--text-primary":"#f9fafb","--text-secondary":"#e5e7eb","--text-tertiary":"#d1d5db","--border-color":"#374151","--border-light":"#4b5563","--gradient-start":"#667eea","--gradient-end":"#764ba2","--shadow":"rgba(0, 0, 0, 0.3)","--ai-bg":"linear-gradient(135deg, #1e293b 0%, #312e81 100%)"}};function applyThemeStyles(e){let a=e;"auto"===e&&(a=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");const t=THEMES[a]||THEMES.light,r=document.documentElement;Object.entries(t).forEach(([e,a])=>{r.style.setProperty(e,a)}),document.body.classList.remove("theme-light","theme-dark"),document.body.classList.add(`theme-${a}`)}async function applyTheme(e,a=!0){if(applyThemeStyles(e),a){let a=e;"auto"===e&&(a=window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light");try{await chrome.storage.local.set({theme:e,appliedTheme:a})}catch(e){console.error("保存主题设置失败:",e)}}}async function loadSavedTheme(){try{const{theme:e}=await chrome.storage.local.get(["theme"]),a=e||"light";await applyTheme(a)}catch(e){console.error("加载主题失败:",e),await applyTheme("light")}}function watchSystemTheme(){window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",async e=>{const{theme:a}=await chrome.storage.local.get(["theme"]);"auto"===a&&await applyTheme("auto")})}"undefined"!=typeof window&&(window.applyTheme=applyTheme,window.applyThemeStyles=applyThemeStyles,window.loadSavedTheme=loadSavedTheme,window.watchSystemTheme=watchSystemTheme);